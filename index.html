<!DOCTYPE html>
<html lang="en-SG">
<head>
<meta charset="UTF-8">
<title>SGEXTN - Home</title>
<style></style>
</head>
<body>
<div id="header"></div>
<div id="contents"></div>
<div id="footer"></div>
<script> (async () => {

// written by ChatGPT
// std::string getTextFile(const std::string& path)
async function getTextFile(path) {
    try {
        const res = await fetch(path);
        if (!res.ok) return 'failed to load resources';
        return await res.text();
    } catch {
        return 'failed to load resources';
    }
}

// translated from C++ to JS by ChatGPT
function genSiteMap(input) {
    let output = "";
    let indent = 0;
    output += '<p class="label">';
    
    const lines = input.split("\n");
    for (let s of lines) {
        s = s.trim();
        if (s === "<") {
            indent--;
        } else if (s === ">") {
            indent++;
        } else if (s.length > 0 && s[0] === "/") {
            output += "\n" + "\t".repeat(indent) + s.substring(1);
        } else if (s.length > 0) {
            output += "\n" + "\t".repeat(indent);
            
            let sl = s.split("").map(c => {
                                    if (c >= "A" && c <= "Z") return c.toLowerCase();
                                    return c;
                                }).join("");
            
            const link = `"./classinfo.html?classname=${sl}"`;
            output += `<a class="link" href=${link}>${s}</a>`;
        }
    }
    
    output += "\n</p>";
    return output;
}

document.querySelector("style").outerHTML = await getTextFile("style.sg");
document.querySelector("#header").outerHTML = await getTextFile("header.sg");
document.querySelector("#footer").outerHTML = await getTextFile("footer.sg");
document.querySelector("#contents").outerHTML = await getTextFile("mainpage/mainpage.sg");
document.querySelector("#sitemap").outerHTML = genSiteMap(await getTextFile("mainpage/sitemap.sg"));

})(); </script>
</body>
</html>
